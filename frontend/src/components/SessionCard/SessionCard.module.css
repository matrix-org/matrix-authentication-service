/* Copyright 2024 The Matrix.org Foundation C.I.C.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

.root {
    position: relative;
}

@media screen and (min-width: 768px) {
    .root:has(.action) .body .header {
        /* We can't exactly know the width of the action button,
         * so we use a somewhat arbitrary safe value:
         *  - the button padding is 4x + 5x
         *  - the icon is 5x wide
         *  - a 2x safe margin
         *  - the approximate width of the button text "Sign out"
         *
         *  Of course that depends on the translation, but it's a good start
         */
        padding-inline-end: calc(var(--cpd-space-16x) + 10ch);
    }
}

@media screen and (max-width: 767px) {
    .root:has(.action) .body {
        /* On small screen, the action button is at the bottom, and we can accurately
         * calculate the height of the button:
         *
         *  - the button padding is 1x + 1x
         *  - its line height is 6.5x
         *  - plus 2x 1px of border (so 0.5x)
         *  - the 4x margin on top of the button
         *  - the regular 6x padding
         */
        padding-block-end: calc(var(--cpd-space-9x) + var(--cpd-space-6x) + var(--cpd-space-6x));
    }
}

.body {
    display: flex;
    gap: var(--cpd-space-4x);
    flex-direction: column;

    border-radius: var(--cpd-space-4x);
    background-color: var(--cpd-color-bg-canvas-default);
    outline: 1px solid var(--cpd-color-border-interactive-secondary);
    outline-offset: -1px;
    box-shadow: 0px 1.2px 2.4px 0px rgba(0, 0, 0, 0.15);
    padding: var(--cpd-space-6x);

    &.disabled {
        outline-color: var(--cpd-color-border-disabled);
        background-color: var(--cpd-color-bg-canvas-disabled);
        box-shadow: none;
    }

    &.compact {
        box-shadow: none;
        padding: var(--cpd-space-3x);
    }
}

a.body:not(.disabled) {
    transition-property: outline-color, box-shadow;
    transition-duration: 0.1s;
    transition-timing-function: linear;

    &:hover,
    &:focus-visible {
        box-shadow: none;
        outline: 2px solid var(--cpd-color-border-interactive-hovered);
        outline-offset: -2px;
    }

    &:focus-visible {
        outline-color: var(--cpd-color-border-focused);
    }
}

@media screen and (min-width: 768px) {
    .action {
        position: absolute;
        /* This padding creates a safe area for the action button */
        padding: var(--cpd-space-6x) var(--cpd-space-6x) var(--cpd-space-2x) var(--cpd-space-2x);
        inset-block-start: 0;
        inset-inline-end: 0;
    }
}

@media screen and (max-width: 767px) {
    .action {
        display: flex;
        flex-direction: column;
        position: absolute;
        padding: var(--cpd-space-6x);
        inset-block-end: 0;
        inset-inline: 0;
    }
}

.header {
    display: flex;
    gap: var(--cpd-space-4x);
    align-items: center;

    & .content {
        display: flex;
        flex-direction: column;

        /* This makes sure it can shrink, and that the text doesn't overflow */
        flex: 0 1 auto;
        min-width: 0;

        & .name {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            font: var(--cpd-font-body-md-semibold);
            letter-spacing: var(--cpd-font-letter-spacing-body-md);
            color: var(--cpd-color-text-primary);
        }

        & .client {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            font: var(--cpd-font-body-sm-regular);
            letter-spacing: var(--cpd-font-letter-spacing-body-sm);
            color: var(--cpd-color-text-secondary);

            & img {
                margin-inline-end: var(--cpd-space-1x);
            }
        }
    }
}

.metadata {
    display: flex;
    flex-wrap: wrap;
    gap: var(--cpd-space-4x) var(--cpd-space-10x);

    & .key {
        font: var(--cpd-font-body-sm-regular);
        letter-spacing: var(--cpd-font-letter-spacing-body-sm);
        color: var(--cpd-color-text-secondary);
    }

    & .value {
        font: var(--cpd-font-body-md-regular);
        letter-spacing: var(--cpd-font-letter-spacing-body-md);
        color: var(--cpd-color-text-primary);
    }
}
